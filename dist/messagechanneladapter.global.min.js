'use strict';self.MessageChannelAdapter=function(){function a(a,c=null){const{port1:d,port2:e}=new MessageChannel;return b(e,a,c),d}function b(e,g,h=null){e.onmessage=(a)=>{h||(h=f());const e=a.data,i=Array.from(d(a.data));for(const d of i){const a=f(),h=c(e,d,a);b(h,g,a)}const j=JSON.stringify({id:h,msg:e,messageChannels:i});g.send(j)},g.addEventListener('message',(b)=>{const d=JSON.parse(b.data);if(h||(h=d.id),h===d.id){const b=d.messageChannels.map((b)=>{const e=b.reduce((a,b)=>a[b],d.msg),f=a(g,e);return c(d.msg,b,f),f});e.postMessage(d.msg,b)}})}function c(a,b,c){for(const d of b.slice(0,-1))a=a[d];const d=b[b.length-1],e=a[d];return a[d]=c,e}function*d(a,b=[]){if(a&&'string'!=typeof a){if(a instanceof MessagePort)return void(yield b.slice());for(const c of Object.keys(a))b.push(c),yield*d(a[c],b),b.pop()}}function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function f(){return Array(g/16).fill(0).map(()=>e()).join('')}const g=128;return{wrap:a}}();